# Pretty Good AI - Voice Bot Challenge

This repository contains an automated voice bot designed to stress-test the Pretty Good AI medical agent. It initiates calls, simulates various patient personas (e.g., irate patient, refill request), records the conversation, and uses GPT-4 to analyze the target agent for quality issues and bugs.

## Project Structure

* **`app.py`**: The core Flask server. It handles Twilio webhooks, manages conversation state, and acts as the "patient brain" using OpenAI.
* **`caller.py`**: A utility script to trigger outbound calls. It injects specific test scenarios (personas) into the call context.
* **`analyzer.py`**: A post-call analysis tool. It reads the JSON transcripts and uses an LLM to generate a bug report automatically.
* **`transcripts/`**: Stores structured JSON logs of every conversation (both sides).
* **`BUG_REPORT.md`**: The final output of the analysis, documenting issues found during testing.

## Prerequisites

* Python 3.8+
* A Twilio Account (SID, Auth Token, and a purchased phone number)
* An OpenAI API Key
* [ngrok](https://ngrok.com/) (for local testing)

## Setup

1.  **Clone the repository:**
    ```bash
    git clone <your-repo-url>
    cd voice-bot-challenge
    ```

2.  **Install dependencies:**
    ```bash
    pip install -r requirements.txt
    ```

3.  **Configure Environment Variables:**
    Create a `.env` file in the root directory and add your keys:
    ```ini
    OPENAI_API_KEY=sk-...
    TWILIO_ACCOUNT_SID=AC...
    TWILIO_AUTH_TOKEN=...
    TWILIO_PHONE_NUMBER=+1...  # Your Twilio number
    TARGET_PHONE_NUMBER=+18054398008 # The Pretty Good AI test line
    BASE_URL=[https://your-ngrok-url.ngrok-free.app](https://your-ngrok-url.ngrok-free.app)
    ```

## How to Run

1.  **Start ngrok:**
    Open a terminal and expose port 5000:
    ```bash
    ngrok http 5000
    ```
    *Copy the HTTPS URL generated by ngrok and paste it into your `.env` file as `BASE_URL`.*

2.  **Start the Bot Server:**
    In a new terminal:
    ```bash
    python app.py
    ```

3.  **Trigger Calls:**
    In a third terminal, run the caller script. This will initiate calls using the scenarios defined in the code.
    ```bash
    python caller.py
    ```

4.  **Generate Bug Report:**
    After your calls are complete, generate the analysis report:
    ```bash
    python analyzer.py
    ```

## License
[MIT](https://choosealicense.com/licenses/mit/)